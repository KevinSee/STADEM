<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STADEM • STADEM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="STADEM">
<meta property="og:description" content="STADEM">
<meta property="og:image" content="https://kevinsee.github.io/STADEM/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">STADEM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/STADEM-vignette.html">STADEM</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KevinSee/STADEM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="STADEM-vignette_files/kePrint-0.0.1/kePrint.js"></script><link href="STADEM-vignette_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>STADEM</h1>
                        <h4 data-toc-skip class="author">Kevin E.
See</h4>
            
            <h4 data-toc-skip class="date">2024-03-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/KevinSee/STADEM/blob/HEAD/vignettes/STADEM-vignette.Rmd" class="external-link"><code>vignettes/STADEM-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>STADEM-vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The STADEM package was developed with the goal of estimating total
adult escapement of spring/summer Chinook salmon and steelhead that
cross Lower Granite dam (LGD). In addition, to meet desired management
and research objectives, total escapement has to include estimates of
uncertainty and be parsed into weekly strata by three origin groups;
wild, hatchery and hatchery no-clip. To reach this goal, we have
developed the <strong>ST</strong>ate space <strong>A</strong>dult
<strong>D</strong>am <strong>E</strong>scapement <strong>M</strong>odel
(STADEM) model that incorporates fish ladder window counts, data from
sampled fish at the LGD adult trap, and observations of previously PIT
tagged fish at LGD adult detection sites.</p>
<p>Some of the data needed for STADEM is available at other dams, and
the package developers are currently working to develop the ability to
query all of the necessary data at other locations. Currently however,
the focus remains on Lower Granite dam, the furthest upstream dam
returning salmonids encounter on the journey up the Snake River. The
following example will show how to run STADEM at Lower Granite for one
species and one year, and what some of the output looks like.</p>
</div>
<div class="section level2">
<h2 id="system-requirements">System requirements<a class="anchor" aria-label="anchor" href="#system-requirements"></a>
</h2>
<p>STADEM relies on the following R packages which can be downloaded via
<a href="https://cran.r-project.org/web/packages/available_packages_by_name.html" class="external-link">CRAN</a>
or by using the function <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>:</p>
<ul>
<li>
<code>dplyr</code>, <code>lubridate</code>, <code>httr</code>: can
all be installed by installing the <code>tidyverse</code> package</li>
<li><code>rjags</code></li>
<li><code>boot</code></li>
</ul>
<p>In addition, STADEM requires the <a href="https://sourceforge.net/projects/mcmc-jags/files/" class="external-link">JAGS
software</a> (Just Another Gibbs Sampler). Please download version &gt;=
4.0.0 via the former link.</p>
</div>
<div class="section level2">
<h2 id="data-sources">Data sources<a class="anchor" aria-label="anchor" href="#data-sources"></a>
</h2>
<p>STADEM relies on several pieces of data, which must be compiled from
multiple sources. Many of them are accessed through the Columbia Basin
Research Data Access in Real Time (<a href="http://www.cbr.washington.edu/dart" class="external-link">DART</a>) website.</p>
<ul>
<li>
<strong>Window counts</strong> are available through DART for many
dams within the Columbia River basin.</li>
<li>
<strong>Trap data</strong> comes from an adult fish trap. This
provides biological information (e.g., origin, genetic stock, age, sex)
to allow the decomposition of total escapement into specific groups, as
well as a secondary estimate of total escapement, if the trap rate is
known or can be reliably estimated.</li>
<li>
<strong>PIT-tag data</strong> comes from fish that were previously
PIT tagged, either as juveniles or as adults at one of the dams
downstream of Lower Granite. These fish provide information about the
proportion of the run that crosses the dam at night, when the counting
window is closed, as well as the proportion of the run that has fallen
back and re-ascended the dam. This data is also available through
DART.</li>
</ul>
</div>
<div class="section level2">
<h2 id="high-level-overview">High-level overview<a class="anchor" aria-label="anchor" href="#high-level-overview"></a>
</h2>
<p>STADEM estimates the total number of fish crossing the dam each week,
based on two major data sources: the window counts and the total fish in
the trap, while also accounting for two known biological processes:
night-time passage and fallback-and-reascension. Using a state-space
approach, STADEM assumes that the window counts and the estimates from
the trap (fish in the trap divided by trap rate that week) are generated
by processes with observation error. In the case of the window counts,
there is some inherent error in the counting process, and it fails to
account for fish that cross the dam while the window is closed. In the
case of the trap, there is sampling variation and uncertainty in what
the realized trap rate is. In addition, STADEM accounts for potential
double-counting of fish that have fallen back and re-ascended the dam.
It then partitions the estimate of total fish over the dam by origin, to
provide the needed data for management goals (Figure
@ref(fig:stadem-model-figure)).</p>
<div class="figure">
<img src="STADEM-vignette_files/figure-html/stadem-model-figure-1.png" alt="Schematic of how the STADEM model works. Panel A shows the posterior of the estimate of fish crossing while the window is open (dashed line shows observed window counts). That estimate is divided by the nighttime passage rate (B). The total fish is then discounted by the reascension rate to estimate unique fish (C). Those unique fish are then multiplied by the proportion of wild fish (D), to estimate unique wild fish." width="576"><p class="caption">
Schematic of how the STADEM model works. Panel A shows the posterior of
the estimate of fish crossing while the window is open (dashed line
shows observed window counts). That estimate is divided by the nighttime
passage rate (B). The total fish is then discounted by the reascension
rate to estimate unique fish (C). Those unique fish are then multiplied
by the proportion of wild fish (D), to estimate unique wild fish.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 id="compiling-data">Compiling data<a class="anchor" aria-label="anchor" href="#compiling-data"></a>
</h2>
<p>The STADEM package relies on many functions from two other packages,
<code>tidyverse</code> for many data manipulation functions and
<code>lubridate</code> for dates and intervals. It also depends upon the
<code>rjags</code> package to run the JAGS program from within R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KevinSee/STADEM" class="external-link">STADEM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mcmc-jags.sourceforge.io" class="external-link">rjags</a></span><span class="op">)</span></span></code></pre></div>
<p>The STADEM package makes it easy to compile all the necessary data in
one convenient function, <code>compileGRAdata</code>. The user provides
the spawn year and species (either “Chinook” or “Steelhead”) they are
interested in. STADEM operates on a weekly time-step, and the user has
the option to determine the day of the week that most strata will begin
on, using the <code>strata_beg</code> argument. There are periodic
messages describing what is being done within
<code>compileGRAdata</code>. Within <code>compileGRAdata</code>, several
internal functions are being called, which may be utilized with the
STADEM package for other purposes. They include:</p>
<ul>
<li>
<code>getWindowCounts</code>: query DART for window counts at
various dams</li>
<li>
<code>queryPITtagData</code>: query DART for data about PIT tags
exhibiting night-time passage and fallback/reascension behavior</li>
<li>
<code>weeklyStrata</code>: divide season into weekly strata, with
the user defining the day of the week each strata should begin with</li>
<li>
<code>summariseLGRtrapDaily</code>: summarize on a daily time-step
the .csv file contained within the Lower Granite Dam trap database</li>
<li>
<code>tagTrapRate</code>: estimate the fish trap rate based on
proportion of PIT tags known to have crossed the dam were caught in the
adult trap</li>
<li>
<code>queryTrapRate</code>: query DART for intended and realized
trap rates, based on time the trap is open</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># what spawning year?</span></span>
<span><span class="va">yr</span> <span class="op">=</span> <span class="fl">2019</span></span>
<span></span>
<span><span class="co"># what species?</span></span>
<span><span class="va">spp</span> <span class="op">=</span> <span class="st">'Chinook'</span></span>
<span></span>
<span><span class="co"># pull together all data</span></span>
<span><span class="va">stadem_list</span> <span class="op">=</span> <span class="fu"><a href="../reference/compileGRAdata.html">compileGRAdata</a></span><span class="op">(</span>spp <span class="op">=</span> <span class="va">spp</span>,</span>
<span>                             start_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">yr</span>, <span class="st">'0301'</span><span class="op">)</span>,</span>
<span>                             end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">yr</span>, <span class="st">'0817'</span><span class="op">)</span>,</span>
<span>                             strata_beg <span class="op">=</span> <span class="st">'Mon'</span>,</span>
<span>                             trap_dbase <span class="op">=</span> <span class="fu"><a href="../reference/readLGRtrapDB.html">readLGRtrapDB</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>                                                                    <span class="st">"Chnk2019_TrapDatabase.csv"</span>, </span>
<span>                                                                    package <span class="op">=</span> <span class="st">"STADEM"</span>,</span>
<span>                                                                    mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/compileGRAdata.html">compileGRAdata()</a></code> function returns several pieces of
information, consolidated into a named list we have called
<code>stadem_list</code>:</p>
<ul>
<li>
<code>weekStrata</code>: weekly strata for STADEM, which are
<code>interval</code> objects from the <code>lubridate</code>
package.</li>
<li>
<code>trapData</code>: data from adult fish trap.</li>
<li>
<code>dailyData</code>: data.frame of data, summarized by day.</li>
<li>
<code>weeklyData</code>: data.frame of data, summarized by weekly
strata.</li>
</ul>
<p>To run STADEM, only <code>weeklyData</code> is needed. STADEM also
includes a function to transform all relevant data from the weekly
summary to a list ready to be passed to JAGS.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compile everything into a list to pass to JAGS</span></span>
<span><span class="va">jags_data_list</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepJAGS.html">prepJAGS</a></span><span class="op">(</span><span class="va">stadem_list</span><span class="op">[[</span><span class="st">'weeklyData'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Prepping JAGS data</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="run-stadem">Run STADEM<a class="anchor" aria-label="anchor" href="#run-stadem"></a>
</h2>
<p>Part of the function <code>runJAGSmodel</code> writes the JAGS model
as a text file. This requires a filename, and the type of statistical
distribution the user would like to use to model the window counts. The
options are Poisson (<code>pois</code>), negative binomial
(<code>neg_bin</code>), a more flexible type of negative binomial,
described in <span class="citation">Lindén and Mäntyniemi (2011)</span>
(<code>neg_bin2</code>), quasi-Poisson (<code>quasi_pois</code>), or as
a normal distribution in log-space (<code>log_space</code>). Once those
have been set, use the <code>runSTADEMmodel</code> function to run the
model in JAGS. Some of the inputs to this function are:</p>
<ul>
<li>
<code>file_name</code> name of text file to write the JAGS model to
(should end in .txt)</li>
<li>
<code>mcmc_chainlength</code> total length of MCMC chain</li>
<li>
<code>mcmc_burn</code> length of burn-in period for MCMC chain</li>
<li>
<code>mcmc_thin</code> thinning rate for with samples of MCMC chain
to keep</li>
<li>
<code>mcmc_chains</code> how many independent chains to run</li>
<li>
<code>jags_data</code> list of data compiled for JAGS, returned by
<code>prepJAGS</code> function</li>
<li>
<code>seed</code> input to <code>set.seed</code> function to make
the results exactly reproducible</li>
<li>
<code>weekly_params</code> Should weekly estimates of escapement be
saved, or only season-wide totals?</li>
<li>
<code>win_model</code> statistical distribution used to model the
window counts</li>
<li>
<code>trap_est</code> if set to <code>FALSE</code>, the estimate of
escapement from the trap and trap rate is not used, and
<code>win_model</code> is automatically set to Poisson.</li>
</ul>
<div class="section level3">
<h3 id="suggestions">Suggestions<a class="anchor" aria-label="anchor" href="#suggestions"></a>
</h3>
<p>Recommended MCMC parameters are:</p>
<ul>
<li>
<code>mcmc_chains</code>: 4</li>
<li>
<code>mcmc_chainLength</code>: 40,000</li>
<li>
<code>mcmc_burn</code>: 10,000</li>
<li>
<code>mcmc_thin</code>: 30</li>
</ul>
<p>This provides a sample of 4,000 draws from the posterior
distribution. Through trial and error, we have also determined the
appropriate burn-in length and thinning interval to meet MCMC posterior
checks.</p>
<p>We also recommend using the negative binomial distribution
(<code>win_model = neg_bin</code>) to model the window counts. In our
experience, all options other than the Poisson distribution provide
similar estimates, with similar estimates of uncertainty. The Poisson
distribution does not allow for the possibility of overdispersion in the
window count data, leading to smaller uncertainty estimates which may
not be appropriate. However, we encourage investigation of how different
distribution choices may affect estimates for particular datasets, and
for users to critically consider the appropriate modeling choice.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># name of JAGS model to write</span></span>
<span><span class="va">model_file_nm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">'STADEM_JAGS_model'</span>, fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># what distribution to use for window counts?</span></span>
<span><span class="va">win_model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'pois'</span>, <span class="st">'neg_bin'</span>, <span class="st">'neg_bin2'</span>, <span class="st">'quasi_pois'</span>, <span class="st">'log_space'</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="co"># run STADEM model</span></span>
<span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="va">stadem_mod</span> <span class="op">=</span> <span class="fu"><a href="../reference/runSTADEMmodel.html">runSTADEMmodel</a></span><span class="op">(</span>file_name <span class="op">=</span> <span class="va">model_file_nm</span>,</span>
<span>                            mcmc_chainLength <span class="op">=</span> <span class="fl">40000</span>,</span>
<span>                            mcmc_burn <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                            mcmc_thin <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                            mcmc_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                            jags_data <span class="op">=</span> <span class="va">jags_data_list</span>,</span>
<span>                            seed <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                            weekly_params <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                            win_model <span class="op">=</span> <span class="va">win_model</span>,</span>
<span>                            trap_est <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="stadem-output">STADEM output<a class="anchor" aria-label="anchor" href="#stadem-output"></a>
</h2>
<p>The JAGS object returned by <code>runSTADEMmodel</code> contains many
parameter estimates. Some of the most important are the total escapement
of various fish (Table @ref(tab:summary-total-escapement)).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">stadem_mod</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summ</span><span class="op">$</span><span class="va">statistics</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"Parameter"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'X.tot'</span>, <span class="va">Parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">kbl</span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">T</span>,</span>
<span>      linesep <span class="op">=</span> <span class="st">""</span>,</span>
<span>      digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Estimates of escapement."</span>,</span>
<span>      format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
Estimates of escapement.
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
SD
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
X.tot.all
</td>
<td style="text-align:right;">
30,253
</td>
<td style="text-align:right;">
1,151.0
</td>
</tr>
<tr>
<td style="text-align:left;">
X.tot.day
</td>
<td style="text-align:right;">
28,794
</td>
<td style="text-align:right;">
1,091.7
</td>
</tr>
<tr>
<td style="text-align:left;">
X.tot.new.all
</td>
<td style="text-align:right;">
27,475
</td>
<td style="text-align:right;">
1,081.2
</td>
</tr>
<tr>
<td style="text-align:left;">
X.tot.new.hatch
</td>
<td style="text-align:right;">
20,769
</td>
<td style="text-align:right;">
864.0
</td>
</tr>
<tr>
<td style="text-align:left;">
X.tot.new.hnc
</td>
<td style="text-align:right;">
1,940
</td>
<td style="text-align:right;">
113.3
</td>
</tr>
<tr>
<td style="text-align:left;">
X.tot.new.wild
</td>
<td style="text-align:right;">
4,765
</td>
<td style="text-align:right;">
215.7
</td>
</tr>
<tr>
<td style="text-align:left;">
X.tot.night
</td>
<td style="text-align:right;">
1,459
</td>
<td style="text-align:right;">
204.9
</td>
</tr>
<tr>
<td style="text-align:left;">
X.tot.night.wild
</td>
<td style="text-align:right;">
237
</td>
<td style="text-align:right;">
36.4
</td>
</tr>
<tr>
<td style="text-align:left;">
X.tot.reasc
</td>
<td style="text-align:right;">
2,778
</td>
<td style="text-align:right;">
267.4
</td>
</tr>
<tr>
<td style="text-align:left;">
X.tot.reasc.wild
</td>
<td style="text-align:right;">
526
</td>
<td style="text-align:right;">
55.3
</td>
</tr>
</tbody>
</table>
<p>Another table that summarizes some of the output by week can be found
by using the code below (Table @ref(tab:week-est-tab)).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">week_df</span> <span class="op">&lt;-</span> <span class="va">summ</span><span class="op">$</span><span class="va">statistics</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^X.all\\["</span>, <span class="va">var</span><span class="op">)</span> <span class="op">|</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^X.day\\["</span>, <span class="va">var</span><span class="op">)</span> <span class="op">|</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^X.night\\["</span>, <span class="va">var</span><span class="op">)</span> <span class="op">|</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^X.reasc\\["</span>, <span class="va">var</span><span class="op">)</span> <span class="op">|</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^X.new.tot\\["</span>, <span class="va">var</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">var</span>, <span class="st">"[0-9]+"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         param <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract_all</a></span><span class="op">(</span><span class="va">var</span>, <span class="st">"[:alpha:]+"</span>, simplify <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>param <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">param</span>,</span>
<span>                        <span class="st">'all'</span> <span class="op">=</span> <span class="st">'Total'</span>,</span>
<span>                        <span class="st">'day'</span> <span class="op">=</span> <span class="st">'Day'</span>,</span>
<span>                        <span class="st">'night'</span> <span class="op">=</span> <span class="st">'Night'</span>,</span>
<span>                        <span class="st">'reasc'</span> <span class="op">=</span> <span class="st">'Reascension'</span>,</span>
<span>                        <span class="st">'new'</span> <span class="op">=</span> <span class="st">'Unique'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">param</span>, <span class="va">week</span>, </span>
<span>         mean <span class="op">=</span> <span class="va">Mean</span>, sd <span class="op">=</span> <span class="va">SD</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># table with point estimates only</span></span>
<span><span class="va">pt_est_tab</span> <span class="op">=</span> <span class="va">week_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">sd</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">param</span>, <span class="va">mean</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">stadem_list</span><span class="op">[[</span><span class="st">'weeklyData'</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>Week <span class="op">=</span> <span class="va">week</span>,</span>
<span>         Win.Cnt <span class="op">=</span> <span class="va">win_cnt</span>,</span>
<span>         <span class="va">Total</span>,</span>
<span>         <span class="va">Day</span>,</span>
<span>         <span class="va">Night</span>,</span>
<span>         <span class="va">Reascension</span>,</span>
<span>         <span class="va">Unique</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># table with point estimates and standard errors</span></span>
<span><span class="va">est_tab</span> <span class="op">=</span> <span class="va">week_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prnt_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">prettyNum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>, <span class="st">' ('</span>, <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">prettyNum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sd</span>, <span class="fl">1</span><span class="op">)</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>, <span class="st">')'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">sd</span>, <span class="op">-</span><span class="va">mean</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">param</span>, <span class="va">prnt_val</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">stadem_list</span><span class="op">[[</span><span class="st">'weeklyData'</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>Week <span class="op">=</span> <span class="va">week</span>,</span>
<span>         Win.Cnt <span class="op">=</span> <span class="va">win_cnt</span>,</span>
<span>         <span class="va">Total</span>,</span>
<span>         <span class="va">Day</span>,</span>
<span>         <span class="va">Night</span>,</span>
<span>         <span class="va">Reascension</span>,</span>
<span>         <span class="va">Unique</span><span class="op">)</span></span>
<span></span>
<span><span class="va">est_tab</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">T</span>,</span>
<span>      linesep <span class="op">=</span> <span class="st">""</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Estimates by week."</span>,</span>
<span>      format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">','</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
Estimates by week.
</caption>
<thead><tr>
<th style="text-align:right;">
Week
</th>
<th style="text-align:right;">
Win.Cnt
</th>
<th style="text-align:left;">
Total
</th>
<th style="text-align:left;">
Day
</th>
<th style="text-align:left;">
Night
</th>
<th style="text-align:left;">
Reascension
</th>
<th style="text-align:left;">
Unique
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
6 (6.9)
</td>
<td style="text-align:left;">
2 (1.3)
</td>
<td style="text-align:left;">
4 (6.6)
</td>
<td style="text-align:left;">
1 (1.2)
</td>
<td style="text-align:left;">
5 (6.2)
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
<td style="text-align:left;">
0 (0)
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
3 (2.2)
</td>
<td style="text-align:left;">
1 (0.7)
</td>
<td style="text-align:left;">
1 (1.8)
</td>
<td style="text-align:left;">
0 (0.3)
</td>
<td style="text-align:left;">
3 (2)
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2 (1.9)
</td>
<td style="text-align:left;">
1 (1.2)
</td>
<td style="text-align:left;">
1 (1)
</td>
<td style="text-align:left;">
0 (0.2)
</td>
<td style="text-align:left;">
2 (1.8)
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
3 (2.8)
</td>
<td style="text-align:left;">
2 (2)
</td>
<td style="text-align:left;">
1 (1.2)
</td>
<td style="text-align:left;">
0 (0.4)
</td>
<td style="text-align:left;">
3 (2.6)
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
10 (4.2)
</td>
<td style="text-align:left;">
8 (2.8)
</td>
<td style="text-align:left;">
2 (2.6)
</td>
<td style="text-align:left;">
1 (0.6)
</td>
<td style="text-align:left;">
9 (3.9)
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
53 (11.6)
</td>
<td style="text-align:left;">
45 (8.6)
</td>
<td style="text-align:left;">
8 (6.4)
</td>
<td style="text-align:left;">
4 (1.7)
</td>
<td style="text-align:left;">
49 (10.9)
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
683
</td>
<td style="text-align:left;">
742 (117.5)
</td>
<td style="text-align:left;">
686 (104.5)
</td>
<td style="text-align:left;">
56 (31.1)
</td>
<td style="text-align:left;">
55 (17.4)
</td>
<td style="text-align:left;">
687 (110.5)
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
5,444
</td>
<td style="text-align:left;">
5,387 (508.1)
</td>
<td style="text-align:left;">
5,156 (485.8)
</td>
<td style="text-align:left;">
232 (70.9)
</td>
<td style="text-align:left;">
419 (84.5)
</td>
<td style="text-align:left;">
4,969 (475.5)
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
4,656
</td>
<td style="text-align:left;">
5,249 (585.4)
</td>
<td style="text-align:left;">
4,954 (552.2)
</td>
<td style="text-align:left;">
295 (87.4)
</td>
<td style="text-align:left;">
411 (85.5)
</td>
<td style="text-align:left;">
4,838 (543.4)
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
4,120
</td>
<td style="text-align:left;">
4,197 (448.3)
</td>
<td style="text-align:left;">
4,005 (426.7)
</td>
<td style="text-align:left;">
193 (61.1)
</td>
<td style="text-align:left;">
327 (71)
</td>
<td style="text-align:left;">
3,870 (418.2)
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
5,143
</td>
<td style="text-align:left;">
4,845 (509.3)
</td>
<td style="text-align:left;">
4,682 (490.6)
</td>
<td style="text-align:left;">
163 (55.1)
</td>
<td style="text-align:left;">
465 (83.1)
</td>
<td style="text-align:left;">
4,381 (467.5)
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
2,646
</td>
<td style="text-align:left;">
2,801 (286.6)
</td>
<td style="text-align:left;">
2,678 (274)
</td>
<td style="text-align:left;">
123 (41.4)
</td>
<td style="text-align:left;">
279 (52.5)
</td>
<td style="text-align:left;">
2,522 (261.1)
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
2,214
</td>
<td style="text-align:left;">
1,989 (239.6)
</td>
<td style="text-align:left;">
1,892 (227)
</td>
<td style="text-align:left;">
98 (33.3)
</td>
<td style="text-align:left;">
222 (46.9)
</td>
<td style="text-align:left;">
1,767 (216.3)
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
1,153
</td>
<td style="text-align:left;">
1,197 (148.3)
</td>
<td style="text-align:left;">
1,138 (139.9)
</td>
<td style="text-align:left;">
59 (25.6)
</td>
<td style="text-align:left;">
139 (33.5)
</td>
<td style="text-align:left;">
1,058 (134.3)
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
1,057
</td>
<td style="text-align:left;">
1,104 (138.8)
</td>
<td style="text-align:left;">
1,041 (128.8)
</td>
<td style="text-align:left;">
63 (27.8)
</td>
<td style="text-align:left;">
126 (31.2)
</td>
<td style="text-align:left;">
978 (125.7)
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
793
</td>
<td style="text-align:left;">
866 (136.4)
</td>
<td style="text-align:left;">
806 (123)
</td>
<td style="text-align:left;">
60 (34.5)
</td>
<td style="text-align:left;">
103 (29.9)
</td>
<td style="text-align:left;">
763 (123.4)
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
477
</td>
<td style="text-align:left;">
543 (80.4)
</td>
<td style="text-align:left;">
517 (76.2)
</td>
<td style="text-align:left;">
26 (14.8)
</td>
<td style="text-align:left;">
63 (18.5)
</td>
<td style="text-align:left;">
480 (72.4)
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
546
</td>
<td style="text-align:left;">
589 (82)
</td>
<td style="text-align:left;">
561 (76.7)
</td>
<td style="text-align:left;">
29 (16.5)
</td>
<td style="text-align:left;">
69 (21)
</td>
<td style="text-align:left;">
520 (74.2)
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
277
</td>
<td style="text-align:left;">
304 (46.1)
</td>
<td style="text-align:left;">
278 (40.3)
</td>
<td style="text-align:left;">
26 (17)
</td>
<td style="text-align:left;">
39 (13.3)
</td>
<td style="text-align:left;">
265 (41.6)
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
163
</td>
<td style="text-align:left;">
169 (26.1)
</td>
<td style="text-align:left;">
158 (23.6)
</td>
<td style="text-align:left;">
11 (7.3)
</td>
<td style="text-align:left;">
25 (9.5)
</td>
<td style="text-align:left;">
144 (23.8)
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:left;">
192 (29.6)
</td>
<td style="text-align:left;">
181 (27.1)
</td>
<td style="text-align:left;">
11 (8.5)
</td>
<td style="text-align:left;">
29 (12.7)
</td>
<td style="text-align:left;">
163 (27.7)
</td>
</tr>
</tbody>
</table>
<p>A user might also like to make time-series plots of estimates, to
compare with window counts and/or trap estimates (Figure
@ref(fig:time-series-plot)). <code>STADEM</code> contains a function to
do that, <code><a href="../reference/plotTimeSeries.html">plotTimeSeries()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot time-series of model estimates, window counts and trap estimates</span></span>
<span><span class="fu"><a href="../reference/plotTimeSeries.html">plotTimeSeries</a></span><span class="op">(</span><span class="va">stadem_mod</span>,</span>
<span>               <span class="va">stadem_list</span><span class="op">$</span><span class="va">weeklyData</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="STADEM-vignette_files/figure-html/time-series-plot-1.png" alt="Time-series plot showing estimates of total escapement for Chinook in 2019, including raw window counts, window counts adjusted for nighttime passage, trap estimates and STADEM estimates." width="672"><p class="caption">
Time-series plot showing estimates of total escapement for Chinook in
2019, including raw window counts, window counts adjusted for nighttime
passage, trap estimates and STADEM estimates.
</p>
</div>
<p>It’s also possible to examine estimates of night-time passage or
re-ascension rates. Figure @ref(fig:rate-figure) shows the observed
values as points, the estimated rates as lines, with 95% credible
intervals around them.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate_est</span> <span class="op">=</span> <span class="va">summ</span><span class="op">$</span><span class="va">quantiles</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^day.true'</span>, <span class="va">var</span><span class="op">)</span> <span class="op">|</span> </span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^reasc.true'</span>, <span class="va">var</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">var</span>, <span class="st">"[0-9]+"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         param <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract_all</a></span><span class="op">(</span><span class="va">var</span>, <span class="st">"[:alpha:]+"</span>, simplify <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">var</span>, <span class="va">param</span>, <span class="va">week</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">stadem_list</span><span class="op">[[</span><span class="st">'weeklyData'</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'week'</span> <span class="op">=</span> <span class="st">'week_num'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rate_est</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start_Date</span>,</span>
<span>             y <span class="op">=</span> <span class="va">`50%`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`2.5%`</span>,</span>
<span>                  ymax <span class="op">=</span> <span class="va">`97.5%`</span>,</span>
<span>                  fill <span class="op">=</span> <span class="va">param</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">param</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">day_tags</span> <span class="op">/</span> <span class="va">tot_tags</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">'day'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">reascent_tags</span> <span class="op">/</span> <span class="va">tot_tags</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">'reasc'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">'Set1'</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">'Rate'</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'day'</span> <span class="op">=</span> <span class="st">'Daytime Passage'</span>,</span>
<span>                                <span class="st">'reasc'</span> <span class="op">=</span> <span class="st">'Reascension'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">'Set1'</span>,</span>
<span>                    name <span class="op">=</span> <span class="st">'Rate'</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'day'</span> <span class="op">=</span> <span class="st">'Daytime Passage'</span>,</span>
<span>                               <span class="st">'reasc'</span> <span class="op">=</span> <span class="st">'Reascension'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">'Estimate'</span>,</span>
<span>       x <span class="op">=</span> <span class="st">'Date'</span>,</span>
<span>       title <span class="op">=</span> <span class="st">'Estimated Rates'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="STADEM-vignette_files/figure-html/rate-figure-1.png" alt="Time-series of estimated day-time passage (red) and re-ascension (blue) rates, with points representing the observed data and shaded polygons represeneting the 95% credible intervals." width="672"><p class="caption">
Time-series of estimated day-time passage (red) and re-ascension (blue)
rates, with points representing the observed data and shaded polygons
represeneting the 95% credible intervals.
</p>
</div>
</div>
<div class="section level2">
<h2 id="additional-options">Additional options<a class="anchor" aria-label="anchor" href="#additional-options"></a>
</h2>
<p>The user does have the option to not use fish caught in the trap as a
secondary estimate of escapement. To turn this feature off, set the
argument <code>trap_est</code> equal to <code>FALSE</code> in the
<code>runSTADEMmodel</code> function. This will constrain the
statistical distribution used to model the window counts as Poisson,
because there is no other way to estimate the variance in those
counts.</p>
<p>If the user would like to summarize STADEM estimates of total unique
escapement, by week, (e.g. as an input to the <a href="https://github.com/mackerman44/SCOBI" class="external-link"><code>SCOBI</code>
package</a>), there is a function to do that,
<code>STADEMtoSCOBI</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scobi_input</span> <span class="op">=</span> <span class="fu"><a href="../reference/STADEMtoSCBOI.html">STADEMtoSCBOI</a></span><span class="op">(</span>stadem_mod <span class="op">=</span> <span class="va">stadem_mod</span>,</span>
<span>                            lgr_weekly <span class="op">=</span> <span class="va">stadem_list</span><span class="op">[[</span><span class="st">'weeklyData'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scobi_input</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">##   model_week StartDate  Strata Estimate    SE Collapse</span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>          1 2019-03-01      9        6  6.94 <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>          2 2019-03-11     10        0  0    <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>          3 2019-03-18     11        0  0    <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>          4 2019-03-25     12        0  0    <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>          5 2019-04-01     13        3  2.22 <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>          6 2019-04-08     14        2  1.89 <span style="color: #BB0000;">NA</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Linden2011" class="csl-entry">
Lindén, Andreas, and Samu Mäntyniemi. 2011. <span>“Using the Negative
Binomial Distribution to Model Overdispersion in Ecological Count
Data.”</span> <em>Ecology</em> 92 (4): 1414–21.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kevin See.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
